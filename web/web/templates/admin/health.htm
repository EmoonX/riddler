<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>ðŸ”’ Health Diagnostics â¬© {{ riddle['full_name'] }}</title>
    <link rel="icon" href="/static/icons/letter-r-icon.png">
    <link rel="fluid-icon" href="/static/icons/letter-r-icon.png" title="Riddler">

    <!-- Less CSS -->
    <link rel="stylesheet/less" type="text/css" href="/static/health.less">
    <script src="//cdn.jsdelivr.net/npm/less@3.13" ></script>
  </head>
  <body>
    <header>
      <h1>Health Diagnostics â¬© {{ riddle['full_name'] }}</h1>
    </header>
    <main>
    {% for level_name, level in levels.items() %}
      <h2>
        {{ level_name }}<!--
     -->{% if level['latinName'] %}
          <span class="smaller">({{ level['latinName'] }})</span>
        {% endif %}
      </h2>
      <ul>
      {% for path, page_data in level['pages'].items() %}
        {% set status_code = page_data['status_code'] %}
        {% if status_code == 200 %}
          {% set status = (
            '<em>âœ¨ new</em> | content hash: ' + page_data['content_hash']
            if page_data['content_hash'] else 'OK'
          ) %}
        {% elif status_code %}
          {% set symbol = page_data['status_symbol'] %}
          {% set status = '[{} {}]'.format(status_code, symbol) %}
          {% set status = '<strong>{}</strong>'.format(status) %}
        {% else %}
          {% set status = '<em style="color: #bbb">skipped</em>' %}
        {% endif %}
        {% if page_data.get('flag', '').startswith('front-') %}
          {% set icon_class = page_data['flag'] %}
          {% set icon_title = page_data['flag'].capitalize().replace('_', ' ') %}
        {% endif %}
        <li{% if icon_class and icon_title %} class="{{ icon_class }}" title="{{ icon_title }}"{% endif %}>
        {% if page_data.get('flag') == 'answer' %}
          <span class="smaller">answer:</span>
        {% endif %}
          <a{% if page_data['hidden'] %} class="translucent" title="(hidden page)"{% endif %} href="{{ page_data['url'] }}" target="_blank" rel="noreferrer">{{ path }}</a>
          {% set redirect_path = page_data['redirects_to'] %}
          {% if redirect_path %}
            {% set url = redirect_path %}
            {% if '://' not in url %}
              {% set url = riddle['root_path'] + url %}
            {% endif %}
            {% set redirect_level = all_pages_by_path.get(redirect_path)['level_name'] %}
            <span class="smaller">
              âžœ <a title="(redirects to)" href="{{ url }}">{{ redirect_path }}</a>
              {% if redirect_level and redirect_level != page_data['level_name'] %}({{ redirect_level }}){% endif %}
            </span>
          {% elif page_data['alias_for'] %}
            {% set url = riddle['root_path'] + page_data['alias_for'] %}
            <span class="smaller">
              (alias for <a href="{{ url }}">{{ page_data['alias_for'] }}</a>)
            </span>
          {% endif %}
          â€¦ {{ status|safe }}
        </li>
      {% endfor %}
      {% set answer_page = all_pages_by_path.get(level['answer']) %}
      {% if answer_page and answer_page['level_name'] != level_name %}
        <li class="smaller">
          answer:
          <a href="{{ answer_page['url'] }}" target="_blank" rel="noreferrer">{{ level['answer'] }}</a>
          ({{ answer_page['level_name'] }})
        </li>
      {% endif %}
      </ul>
    {% endfor %}
    </main>
  </body>
</html>
