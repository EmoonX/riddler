{% extends 'layout.htm' %}
{% block title %}All riddles ⬩ Riddler{% endblock %}
{% block content %}
    <main>
      {% set riddles = get_riddles(unlisted=True) %}
      {% set statuses = {
        '🎖️': 'Full',
        '🚧': 'Update in Progress',
        '🧪': 'Demo',
      } %}
      <h1>All riddles</h1>
      <table>
        <thead>
          <th>Status</th>
          <th>Riddle</th>
          <th>Players</th>
          <th>Levels</th>
          <th>Pages</th>
          <th>Links</th>
        </thead>
        <tbody>
        {% for riddle in riddles|sort(attribute="full_name") %}
          <tr>
            <td>
            {%- if riddle['status'] -%}
              <span title="{{ statuses[riddle['status']] }}" style="border-bottom: 1px dotted #ffd8;">{{ riddle['status'] }}</span>
            {%- endif -%}
            </td>
            <td style="text-align: left;">
              <a href="{{ riddle['alias'] }}" style="display: inline-flex; align-items: center; gap: .6em; vertical-align: middle;">
                {% set src = '/static/riddles/' ~ riddle['alias'] ~ '.png' %}
              {% if file_exists(src) %}
                <img class="riddle-icon" src="{{ src }}" width="35">
              {% else %}
                <div style="display: inline-block; width: 35px; height: 35px;"></div>
              {% endif %}
                {{ riddle['full_name'] }}
              </a>
            </td>
            <td>
              <var class="player-count">
              {%- if riddle['player_count'] -%}
                {{ riddle['player_count'] }}<span class="bg-emoji">👤</span>
              {%- else -%}
                <span style="opacity: .3;">--</span>
              {%- endif -%}
              </var>
            </td>
            <td>
              <var class="level-count">
              {%- if riddle['level_count'] -%}
                {{ riddle['level_count'] }}<span class="bg-emoji">🧩</span>
              {%- else -%}
                <span style="opacity: .3;">--</span>
              {%- endif -%}
              </var>
            </td>
            <td>
              <var class="page-count">
              {%- if riddle['page_count'] -%}
                <span style="font-size: .8em;">{{ riddle['page_count'] }}</span><span class="bg-emoji">📄</span>
              {%- else -%}
                <span style="opacity: .3;">--</span>
              {%- endif -%}
              </var>
            </td>
            <td>
              <a href="{{ riddle['front_page'] }}" target="_blank" rel="noreferrer"><img src="/static/icons/external-link.png" width="30"></a>
            {% if riddle['invite_code'] %}
              <a href="https://discord.gg/{{ riddle['invite_code'] }}" target="_blank"><img src="/static/icons/discord.png" width="30"></a>
            {% endif %}
            {% if riddle['nordinho_link'] %}
              <a href="{{ riddle['nordinho_link'] }}" target="_blank"><img src="/static/icons/nordinho.png" width="30"></a>
            {% endif %}
            </td>
          </tr>
        {% endfor %}
        </tbody>
      </table>
    </main>
{% endblock %}
